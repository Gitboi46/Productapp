<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Sneakers AR Experience</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #001a1a;
      color: #f2f2f2; 
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    #cameraBackground {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      object-fit: cover;
      z-index: 1;
    }
    #introScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
    }
    .intro-ripple {
      position: absolute;
      width: 300px; height: 300px;
      border-radius: 50%;
      border: 1px solid rgba(0, 255, 204, 0.2);
      animation: rippleExpand 3s ease-out infinite;
    }
    .intro-ripple:nth-child(2) { animation-delay: 1s; }
    .intro-ripple:nth-child(3) { animation-delay: 2s; }
    @keyframes rippleExpand {
      0% { transform: scale(0.5); opacity: 1; }
      100% { transform: scale(2); opacity: 0; }
    }
    .press-button {
      position: relative;
      width: 180px; height: 180px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(0, 255, 204, 0.2), rgba(0, 220, 180, 0.1), rgba(0, 180, 140, 0.15));
      border: 2px solid rgba(0, 255, 204, 0.3);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: bold;
      color: #00ffcc;
      text-align: center;
      animation: pulseButton 2.5s infinite;
      backdrop-filter: blur(10px);
      z-index: 10;
    }
    @keyframes pulseButton {
      0%, 100% { transform: scale(1); box-shadow: 0 0 40px rgba(0, 255, 204, 0.3); }
      50% { transform: scale(1.02); box-shadow: 0 0 60px rgba(0, 255, 204, 0.4); }
    }
    .press-button:active { transform: scale(0.95); }
    #videoScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 90;
      display: none;
      align-items: center;
      justify-content: center;
      perspective: 1200px;
      overflow: hidden;
      background: transparent;
    }
   
    .particles-container {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: 2;
    }
   
    .particle {
      position: absolute;
      border-radius: 50%;
      animation: floatParticle linear infinite;
    }
    .particle.glow {
      background: radial-gradient(circle, rgba(0, 255, 204, 0.7) 0%, rgba(0, 255, 204, 0.4) 40%, transparent 70%);
      box-shadow: 0 0 6px rgba(0, 255, 204, 0.5);
    }
    .particle.spark {
      background: radial-gradient(circle, rgba(0, 255, 230, 0.8) 0%, rgba(0, 220, 200, 0.5) 50%, transparent 70%);
      box-shadow: 0 0 5px rgba(0, 255, 230, 0.4);
    }
    .particle.orb {
      background: radial-gradient(circle, rgba(0, 220, 180, 0.8) 0%, rgba(0, 255, 204, 0.4) 50%, transparent 70%);
      box-shadow: 0 0 6px rgba(0, 220, 180, 0.4);
    }
    @keyframes floatParticle {
      0% { transform: translateY(100vh) rotate(0deg) scale(0.5); opacity: 0; }
      10% { opacity: 1; }
      50% { opacity: 1; transform: translateY(50vh) rotate(360deg) scale(1); }
      90% { opacity: 0.8; }
      100% { transform: translateY(-50px) rotate(720deg) scale(0.5); opacity: 0; }
    }
    .particle.sway {
      animation: floatParticleSway linear infinite;
    }
    @keyframes floatParticleSway {
      0% { transform: translateY(100vh) translateX(0) scale(0.5); opacity: 0; }
      10% { opacity: 1; }
      25% { transform: translateY(75vh) translateX(20px) scale(0.8); }
      50% { transform: translateY(50vh) translateX(-15px) scale(1); opacity: 1; }
      75% { transform: translateY(25vh) translateX(15px) scale(0.9); }
      90% { opacity: 0.7; }
      100% { transform: translateY(-50px) translateX(0) scale(0.5); opacity: 0; }
    }
   
    .sound-waves {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: flex-end;
      gap: 4px;
      height: 35px;
      z-index: 96;
    }
    .wave-bar {
      width: 3px;
      background: linear-gradient(to top, #00ffcc, #00ffc4, #00ff99);
      border-radius: 3px;
      animation: waveAnimation 0.5s ease-in-out infinite alternate;
      box-shadow: 0 0 8px rgba(0, 255, 204, 0.4);
    }
    @keyframes waveAnimation {
      0% { height: 5px; }
      100% { height: 28px; }
    }
    .spatial-container {
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.1s ease-out;
      will-change: transform;
      z-index: 10;
    }
    .spatial-frame {
      position: relative;
      width: 220px; height: 390px;
      transform-style: preserve-3d;
    }
   
    .video-glow {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 250px; height: 420px;
      border-radius: 20px;
      background: radial-gradient(ellipse at center,
        rgba(0, 255, 204, 0.25) 0%,
        rgba(0, 220, 180, 0.15) 30%,
        rgba(0, 180, 140, 0.08) 50%,
        transparent 70%);
      filter: blur(30px);
      animation: bgGlowPulse 3s ease-in-out infinite;
      pointer-events: none;
      z-index: -1;
    }
    .video-glow-secondary {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 280px; height: 450px;
      border-radius: 25px;
      background: radial-gradient(ellipse at center,
        rgba(0, 220, 180, 0.2) 0%,
        rgba(0, 200, 160, 0.12) 35%,
        transparent 65%);
      filter: blur(40px);
      animation: bgGlowPulse2 4s ease-in-out infinite;
      pointer-events: none;
      z-index: -1;
    }
    @keyframes bgGlowPulse {
      0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(1); }
      50% { opacity: 0.7; transform: translate(-50%, -50%) scale(1.05); }
    }
    @keyframes bgGlowPulse2 {
      0%, 100% { opacity: 0.4; transform: translate(-50%, -50%) scale(1); }
      50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.05); }
    }
   
    .depth-layer-back { position: absolute; top: 8px; left: 8px; width: 204px; height: 374px; background: rgba(0,0,0,0.2); border-radius: 12px; transform: translateZ(-60px); }
    .depth-layer-mid { position: absolute; top: 4px; left: 4px; width: 212px; height: 382px; background: rgba(0,0,0,0.15); border-radius: 14px; transform: translateZ(-30px); }
    .video-spatial-container {
      position: relative;
      width: 220px; height: 390px;
      transform-style: preserve-3d;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 40px rgba(0, 255, 204, 0.15);
    }
    #videoPlayer {
      width: 100%; height: 100%;
      object-fit: cover;
      border-radius: 15px;
    }
    .visualize-button {
      position: absolute;
      bottom: 15px; left: 50%;
      transform: translateX(-50%);
      padding: 8px 18px;
      font-size: 10px;
      font-weight: 500;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.2);
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
      color: #f7faf9;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      z-index: 10;
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s ease;
    }
    .visualize-button.visible { opacity: 1; visibility: visible; }
    .visualize-button:active { transform: translateX(-50%) scale(0.95); }
    .floor-shadow {
      position: absolute;
      bottom: -60px; left: 50%;
      transform: translateX(-50%);
      width: 180px; height: 80px;
      background: radial-gradient(ellipse at center, rgba(0,0,0,0.4) 0%, transparent 70%);
      filter: blur(15px);
    }
    #modelsScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 80;
      display: none;
      flex-direction: column;
      overflow: hidden;
      background: transparent;
    }
   
    @keyframes fadeSlideIn {
      0% { opacity: 0; transform: translateY(30px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    @keyframes cardFadeIn {
      0% { opacity: 0; transform: translateY(20px) scale(0.95); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    .shimmer-border {
      position: absolute;
      inset: -2px;
      border-radius: 22px;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 204, 0.2), rgba(0, 220, 180, 0.2), transparent);
      background-size: 200% 100%;
      animation: shimmer 3s linear infinite;
      z-index: -1;
      opacity: 0.4;
    }
   
    .models-scroll-container {
      flex: 1;
      overflow-y: auto;
      padding: 20px 12px;
      padding-bottom: 100px;
    }
    .models-header {
      text-align: center;
      margin-bottom: 20px;
      padding: 20px 15px;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      animation: fadeSlideIn 0.5s ease-out forwards;
    }
    .models-header h2 { font-size: 22px; font-weight: 700; margin-bottom: 5px; color: #fdaa10; }
    .models-header p { font-size: 12px; opacity: 0.7; color: #ffffff; }
    .shoes-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 15px;
      max-width: 400px;
      margin: 0 auto;
      padding-bottom: 20px;
    }
    .shoe-card {
      background: transparent;
      border-radius: 20px;
      overflow: visible;
      opacity: 0;
      animation: cardFadeIn 0.6s ease-out forwards;
      position: relative;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .shoe-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 15px 30px rgba(255, 145, 11, 0.35);
    }
    .shoe-card:nth-child(1) { animation-delay: 0.1s; }
    .shoe-card:nth-child(2) { animation-delay: 0.2s; }
    .shoe-card:nth-child(3) { animation-delay: 0.3s; }
    .shoe-card:nth-child(4) { animation-delay: 0.4s; }
    .shoe-card:nth-child(5) { animation-delay: 0.5s; }
    .shoe-card:nth-child(6) { animation-delay: 0.6s; }
    .shoe-card:nth-child(7) { animation-delay: 0.7s; }
    .shoe-card:nth-child(8) { animation-delay: 0.8s; }
    .shoe-card:nth-child(9) { animation-delay: 0.9s; }
    .shoe-card:nth-child(10) { animation-delay: 1.0s; }
    .shoe-card:nth-child(11) { animation-delay: 1.1s; }
    .shoe-card:nth-child(12) { animation-delay: 1.2s; }
    .shoe-card:nth-child(13) { animation-delay: 1.3s; }
   
    .model-wrap {
      height: 190px;
      background: linear-gradient(135deg, #0a2a2a, #001a1a);
      border-radius: 18px;
      overflow: hidden;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .model-wrap img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      padding: 20px;
    }
    .info {
      padding: 18px 15px;
      text-align: center;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      margin-top: 10px;
    }
    .info h3 { font-size: 18px; margin-bottom: 5px; font-weight: 600; color: #ffb10a; }
    .info .price { opacity: 0.7; font-size: 15px; margin-bottom: 15px; color: #ffffff; }
    .btn-3d-home {
      background: #fff;
      color: #000;
      border: none;
      padding: 14px 20px;
      border-radius: 30px;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin: 0 auto;
      width: 100%;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .btn-3d-home::before {
      content: '';
      position: absolute;
      top: 0; left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.6s;
    }
    .btn-3d-home:hover {
      background: #e59c00;
      color: #000;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 255, 204, 0.4);
    }
    .btn-3d-home:hover::before {
      left: 100%;
    }
    .btn-3d-home:active { 
      transform: scale(0.97); 
      background: #e59c00; 
    }

    /* ADVERTISEMENT BANNER */
    .ad-banner {
      margin: 20px auto;
      max-width: 360px;
      background: linear-gradient(135deg, rgba(255, 145, 11, 0.15), rgba(0, 255, 204, 0.1));
      border: 1px solid rgba(255, 145, 11, 0.4);
      border-radius: 20px;
      padding: 18px 15px;
      text-align: center;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(12px);
      animation: cardFadeIn 0.8s ease-out forwards;
      box-shadow: 0 8px 32px rgba(255, 145, 11, 0.2);
    }
    .ad-banner::before {
      content: '';
      position: absolute;
      top: -50%; left: -50%;
      width: 200%; height: 200%;
      background: radial-gradient(circle, rgba(255, 145, 11, 0.15) 0%, transparent 70%);
      animation: adGlow 8s linear infinite;
      pointer-events: none;
    }
    @keyframes adGlow {
      0% { transform: translate(0%, 0%) rotate(0deg); }
      100% { transform: translate(50%, 50%) rotate(360deg); }
    }
    .ad-banner h3 {
      font-size: 20px;
      color: #ffb10a;
      margin-bottom: 6px;
      font-weight: 700;
    }
    .ad-banner p {
      font-size: 14px;
      color: #ffffff;
      margin-bottom: 10px;
    }
    .ad-banner .highlight {
      font-size: 24px;
      font-weight: 900;
      background: linear-gradient(90deg, #ffb10a, #ff6b00);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .ad-banner .cta {
      margin-top: 12px;
      padding: 10px 24px;
      background: #ffb10a;
      color: #000;
      border: none;
      border-radius: 30px;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
    }

    .back-to-video-btn {
      position: fixed;
      bottom: 25px; left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.4);
      border: 1px solid rgba(255,255,255,0.2);
      color: #e6e6e6;
      padding: 12px 30px;
      border-radius: 25px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      z-index: 86;
      backdrop-filter: blur(10px);
    }
    .back-to-video-btn:active { transform: translateX(-50%) scale(0.95); }
    #arDetailView {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      display: none;
      z-index: 110;
      background: transparent;
      overflow: hidden;
    }
   
    #arModelContainer {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 111;
      touch-action: none;
    }
   
    #ar3DModel {
      width: 100%;
      height: 100%;
      --poster-color: transparent;
      background-color: transparent !important;
      touch-action: none !important;
    }

    .top-bar {
      position: fixed;
      top: 20px; left: 15px; right: 15px;
      display: flex;
      justify-content: center;
      z-index: 115;
      pointer-events: none;
    }
    .model-name-badge {
      background: rgba(0,0,0,0.4);
      padding: 8px 20px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      color: #00ffcc;
      backdrop-filter: blur(10px);
      pointer-events: auto;
    }
    .gesture-hint {
      position: fixed;
      top: 70px; left: 50%;
      transform: translateX(-50%);
      font-size: 11px;
      color: #f9f9f9;
      text-align: center;
      background: rgba(0,0,0,0.3);
      padding: 8px 16px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      z-index: 115;
      opacity: 1;
      transition: opacity 0.5s ease;
      pointer-events: none;
    }
    .gesture-hint.hidden { opacity: 0; }
    .bottom-bar {
      position: fixed;
      bottom: 25px; left: 15px; right: 15px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      z-index: 115;
      pointer-events: none;
    }
   
    .capture-btn {
      background: rgba(0,0,0,0.4);
      border: 2px solid rgba(255,255,255,0.4);
      color: #f8f8f8;
      padding: 14px 35px;
      border-radius: 30px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      pointer-events: auto;
    }
    .capture-btn:active { transform: scale(0.95); background: rgba(255,255,255,0.1); }
    .order-btn {
      background: linear-gradient(135deg, #e59c00, #e59c00);
      color: white;
      border: none;
      padding: 14px 40px;
      border-radius: 30px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      max-width: 280px;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 20px rgba(0,255,204,0.4);
      pointer-events: auto;
    }
    .order-btn:active { transform: scale(0.97); }

    .action-row {
      display: flex;
      gap: 10px;
      width: 100%;
      max-width: 280px;
      justify-content: center;
    }
    .action-btn {
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.2);
      color: #ffb10a;
      padding: 10px 18px;
      border-radius: 20px;
      font-size: 11px;
      cursor: pointer;
      backdrop-filter: blur(10px);
      flex: 1;
      text-align: center;
      pointer-events: auto;
    }
    .action-btn:active { background: rgba(255,255,255,0.1); }
    #captureCanvas { display: none; }
    .loading-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
      flex-direction: column;
      gap: 15px;
    }
    .loading-overlay.active { display: flex; }
    .loader {
      width: 40px; height: 40px;
      border: 3px solid rgba(255,255,255,0.2);
      border-top-color: #00ffcc;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>  
  <video id="cameraBackground" autoplay playsinline></video>
  <canvas id="captureCanvas"></canvas>
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loader"></div>
    <div style="color:#00ffcc;">Loading Model...</div>
  </div>
  <div id="introScreen">
    <div class="intro-ripple"></div>
    <div class="intro-ripple"></div>
    <div class="intro-ripple"></div>
    <button class="press-button" id="startBtn">TAP TO<br>START</button>
  </div>

  <div id="videoScreen">
    <div class="particles-container" id="particlesContainer"></div>
    <div class="sound-waves" id="soundWaves">
      <div class="wave-bar" style="animation-delay: 0s;"></div>
      <div class="wave-bar" style="animation-delay: 0.1s;"></div>
      <div class="wave-bar" style="animation-delay: 0.2s;"></div>
      <div class="wave-bar" style="animation-delay: 0.3s;"></div>
      <div class="wave-bar" style="animation-delay: 0.4s;"></div>
      <div class="wave-bar" style="animation-delay: 0.35s;"></div>
      <div class="wave-bar" style="animation-delay: 0.25s;"></div>
      <div class="wave-bar" style="animation-delay: 0.15s;"></div>
      <div class="wave-bar" style="animation-delay: 0.05s;"></div>
    </div>
    <div class="spatial-container" id="spatialContainer">
      <div class="spatial-frame">
        <div class="video-glow"></div>
        <div class="video-glow-secondary"></div>
        <div class="depth-layer-back"></div>
        <div class="depth-layer-mid"></div>
        <div class="video-spatial-container">
          <video id="videoPlayer" playsinline loop>
            <source src="https://raw.githubusercontent.com/ElwinRoy/ModelViewer/main/Avatar%20IV%20Standing.mp4" type="video/mp4">
          </video>
          <button class="visualize-button" id="visualizeBtn">View Products</button>
        </div>
        <div class="floor-shadow"></div>
      </div>
    </div>
  </div>

  <!-- MODELS SCREEN -->
  <div id="modelsScreen">
    <div class="models-scroll-container" id="scrollContainer">
      <div class="models-header">
        <h2>Choose Your Product</h2>
        <p>Select a Product to view in AR</p>
      </div>
      <div class="shoes-grid" id="shoesGrid"></div>
    </div>
    <button class="back-to-video-btn" id="backToVideoBtn">Back to Video</button>
  </div>

  <!-- AR DETAIL VIEW -->
  <div id="arDetailView">
    <div id="arModelContainer">
      <img id="ar3DModel" src="" alt="Product" style="width: 100%; height: 100%; object-fit: contain; background: transparent;">
    </div>

    <div class="top-bar">
      <div class="model-name-badge" id="modelName">Sneaker</div>
    </div>
   
    <div class="gesture-hint" id="gestureHint">
      One finger to rotate • Two fingers to move • Pinch to zoom
    </div>
    <div class="bottom-bar">
      <button class="capture-btn" id="captureBtn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <circle cx="12" cy="12" r="4"/>
        </svg>
        Capture
      </button>
      <button class="order-btn" id="orderBtn">Order Now</button>
      <div class="action-row">
        <button class="action-btn" id="replayBtn">Replay</button>
        <button class="action-btn" id="backBtn">Back</button>
      </div>
    </div>
  </div>

  <script>
    const shoes = [
  { name: "Book Marker", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Book%20Marker.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Book%20Marker.png" },
  { name: "Calander", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Calander.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Calander.png" },
  { name: "Coffee Mug", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Coffee%20mug.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Coffee%20mug.png" },
  { name: "Story Book", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Story%20Book.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Story%20Book.png" },
  { name: "Diary", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Dairy.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Dairy.png" },
  { name: "Bottle", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Bottle.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Bottle.png" },
  { name: "Drawing Book", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Drawing%20book.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Drawing%20book.png" },
  { name: "Fridge Magnet", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Fridge%20Magnet.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Fridge%20Magnet.png" },
  { name: "Key Chain", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Key%20Chain.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Key%20Chain.png" },
  { name: "Photo Frame", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Photo%20Frame.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Photo%20Frame.png" },
  { name: "Sticker", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Sticker.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Sticker.png" },
  { name: "Tota Bag", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Tota%20bag.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Tota%20bag.png" },
  { name: "Pocket Card", price: "INR", model: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/pocket%20card.png", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/pocket%20card.png" }
];
    const ORDER_URL = "https://www.superkicks.in/";

    const $ = id => document.getElementById(id);
    const el = {
      camera: $("cameraBackground"),
      intro: $("introScreen"),
      video: $("videoScreen"),
      models: $("modelsScreen"),
      ar: $("arDetailView"),
      model3d: $("ar3DModel"),
      arContainer: $("arModelContainer"),
      startBtn: $("startBtn"),
      visualizeBtn: $("visualizeBtn"),
      videoPlayer: $("videoPlayer"),
      shoesGrid: $("shoesGrid"),
      modelName: $("modelName"),
      loading: $("loadingOverlay"),
      captureBtn: $("captureBtn"),
      orderBtn: $("orderBtn"),
      replayBtn: $("replayBtn"),
      backBtn: $("backBtn"),
      backToVideoBtn: $("backToVideoBtn"),
      particlesContainer: $("particlesContainer"),
      spatialContainer: $("spatialContainer"),
      captureCanvas: $("captureCanvas"),
      gestureHint: $("gestureHint")
    };
    let currentShoe = null;
    let lastLoadedUrl = null;

    // PREMIUM HAPTIC ENGINE
    const Haptic = {
      supported: 'vibrate' in navigator,
      click() { if(this.supported) navigator.vibrate(30); },
      double() { if(this.supported) navigator.vibrate([30, 60, 30]); },
      success() { if(this.supported) navigator.vibrate([80, 80, 160]); },
      impact() { if(this.supported) navigator.vibrate(100); },
      excite() { if(this.supported) navigator.vibrate([60, 60, 60, 60, 120, 80, 200]); },
      capture() { if(this.supported) navigator.vibrate([40, 100, 60]); },
      order() { if(this.supported) navigator.vibrate([100, 80, 100, 80, 200, 150, 300]); },
      startup() { if(this.supported) navigator.vibrate([100, 80, 100, 80, 200, 100, 300]); },
      videoPulse: null,
      videoStart() {
        if(!this.supported) return;
        const pattern = [40, 80, 40, 80, 40, 120];
        const pulse = () => navigator.vibrate(pattern);
        pulse();
        this.videoPulse = setInterval(pulse, 1200);
      },
      videoStop() {
        if(this.videoPulse) clearInterval(this.videoPulse);
        if(this.supported) navigator.vibrate(0);
      }
    };

    // CAMERA INITIALIZATION — NO AUDIO
    async function initCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ 
          video: { facingMode: "environment" }   // audio removed
        });
        el.camera.srcObject = stream;
      } catch (e) { 
        document.body.style.background = "#001a1a"; 
      }
    }
    initCamera();

    function createParticles() {
      const c = el.particlesContainer; c.innerHTML = '';
      for (let i = 0; i < 12; i++) {
        const p = document.createElement('div');
        p.className = `particle ${['glow','spark','orb'][i%3]} ${i%2?'sway':''}`;
        const s = Math.random()*3+2;
        p.style.width = p.style.height = s+'px';
        p.style.left = Math.random()*100+'%';
        p.style.animationDuration = (Math.random()*5+6)+'s';
        p.style.animationDelay = Math.random()*6+'s';
        c.appendChild(p);
      }
    }

    el.startBtn.onclick = () => {
      Haptic.startup();
      el.intro.style.display = "none";
      el.video.style.display = "flex";
      el.videoPlayer.play();            // promotional video still has sound
      Haptic.videoStart();
      createParticles();
      setTimeout(() => el.visualizeBtn.classList.add('visible'), 5000);
    };

    el.visualizeBtn.onclick = () => {
      Haptic.excite();
      Haptic.videoStop();
      el.videoPlayer.pause();
      el.video.style.display = "none";
      el.models.style.display = "flex";
    };

    el.backToVideoBtn.onclick = () => {
      Haptic.double();
      el.models.style.display = "none";
      el.video.style.display = "flex";
      el.videoPlayer.currentTime = 0;
      el.videoPlayer.play();
      Haptic.videoStart();
      createParticles();
    };

    shoes.forEach((shoe, i) => {
      const card = document.createElement("div"); 
      card.className = "shoe-card";
      card.innerHTML = `
        <div class="shimmer-border"></div>
        <div class="model-wrap">
          <img src="${shoe.img}" alt="${shoe.name}">
        </div>
        <div class="info">
          <h3>${shoe.name}</h3>
          <div class="price">${shoe.price}</div>
          <button class="btn-3d-home" data-i="${i}">View in AR</button>
        </div>`;
      el.shoesGrid.appendChild(card);

      if ((i + 1) % 2 === 0 && i !== shoes.length - 1) {
        const ad = document.createElement("div");
        ad.className = "ad-banner";
        ad.innerHTML = `
          <h3>FLASH SALE!</h3>
          <p>Get <span class="highlight">UPTO 50% OFF</span></p>
          <p>Limited Time Offer on All Products</p>
          <button class="cta" onclick="window.open('https://www.superkicks.in/collections/sale', '_blank')">Shop Now</button>
        `;
        el.shoesGrid.appendChild(ad);
      }
    });

    document.querySelectorAll('.btn-3d-home').forEach(btn => {
      btn.onclick = () => {
        Haptic.excite();
        const i = parseInt(btn.dataset.i);
        currentShoe = shoes[i];
        el.modelName.textContent = currentShoe.name;
        el.loading.classList.add('active');
        el.models.style.display = "none";
        el.ar.style.display = "block";
        el.arContainer.style.display = "block";

        const newUrl = currentShoe.model;
        if (lastLoadedUrl === newUrl) {
          el.model3d.src = '';
          requestAnimationFrame(() => {
            el.model3d.src = newUrl + (newUrl.includes('?') ? '&' : '?') + Date.now();
          });
        } else {
          el.model3d.src = newUrl;
        }
        lastLoadedUrl = newUrl;

        el.model3d.addEventListener('load', () => {
          el.loading.classList.remove('active');
        }, { once: true });
      };
    });

    el.captureBtn.onclick = async () => {
      Haptic.capture();
      const canvas = el.captureCanvas;
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      ctx.drawImage(el.camera, 0, 0, canvas.width, canvas.height);
      
      const productImg = el.model3d;
      const iw = productImg.naturalWidth;
      const ih = productImg.naturalHeight;
      const cw = canvas.width;
      const ch = canvas.height;
      if (iw > 0 && ih > 0) {
        const iar = iw / ih;
        const car = cw / ch;
        let dx = 0, dy = 0, dw = cw, dh = ch;
        if (iar > car) {
          dh = ch;
          dw = dh * iar;
          dx = (cw - dw) / 2;
        } else {
          dw = cw;
          dh = dw / iar;
          dy = (ch - dh) / 2;
        }
        ctx.drawImage(productImg, dx, dy, dw, dh);
      }
      
      canvas.toBlob(blob => {
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = `${currentShoe?.name.replace(/ /g, '_') || 'AR'}_Capture.png`;
        a.click();
        Haptic.success();
      });
    };

    el.orderBtn.onclick = () => {
      Haptic.order();
      window.open(ORDER_URL, '_blank');
    };

    el.replayBtn.onclick = () => { 
      Haptic.success();
      el.ar.style.display = "none"; 
      el.video.style.display = "flex"; 
      el.videoPlayer.currentTime = 0; 
      el.videoPlayer.play(); 
      Haptic.videoStart(); 
      createParticles(); 
    };

    el.backBtn.onclick = () => { 
      Haptic.double();
      el.ar.style.display = "none"; 
      el.models.style.display = "flex"; 
    };
  </script>
</body>
</html>
